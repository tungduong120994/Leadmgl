@{
    Layout = "~/Views/Shared/_Layout.cshtml";

}

@section scripHeadLeadSach{
    <link rel="stylesheet" type="text/css" href="/Assets/global/plugins/select2/select2.css" />
    <link rel="stylesheet" type="text/css" href="/Assets/global/plugins/datatables/extensions/Scroller/css/dataTables.scroller.min.css" />
    <link rel="stylesheet" type="text/css" href="/Assets/global/plugins/datatables/extensions/ColReorder/css/dataTables.colReorder.min.css" />
    <link rel="stylesheet" type="text/css" href="/Assets/global/plugins/datatables/plugins/bootstrap/dataTables.bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="/Assets/global/plugins/clockface/css/clockface.css" />
    <link rel="stylesheet" type="text/css" href="/Assets/global/plugins/bootstrap-datepicker/css/bootstrap-datepicker3.min.css" />
    <link rel="stylesheet" type="text/css" href="/Assets/global/plugins/bootstrap-timepicker/css/bootstrap-timepicker.min.css" />
    <link rel="stylesheet" type="text/css" href="/Assets/global/plugins/bootstrap-colorpicker/css/colorpicker.css" />
    <link rel="stylesheet" type="text/css" href="/Assets/global/plugins/bootstrap-daterangepicker/daterangepicker-bs3.css" />
    <link rel="stylesheet" type="text/css" href="/Assets/global/plugins/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css" />
}

<div class="page-content-wrapper">

    <div class="page-content">
        <!-- BEGIN SAMPLE PORTLET CONFIGURATION MODAL FORM-->
        <div class="modal fade" id="portlet-config" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                        <h4 class="modal-title">Modal title</h4>
                    </div>
                    <div class="modal-body">
                        Widget settings form goes here
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn blue">Save changes</button>
                        <button type="button" class="btn default" data-dismiss="modal">Close</button>
                    </div>
                </div>
                <!-- /.modal-content -->
            </div>
            <!-- /.modal-dialog -->
        </div>
        <h3 class="page-title">
            Lead Sạch <small></small>

        </h3>
        <br />
        @*<div class="page-bar">

                <div class="page-toolbar">
                    <div class="btn-group pull-right">
                        <button type="button" class="btn btn-fit-height grey-salt dropdown-toggle" data-toggle="dropdown" data-hover="dropdown" data-delay="1000" data-close-others="true">
                            Actions <i class="fa fa-angle-down"></i>
                        </button>
                        <ul class="dropdown-menu pull-right" role="menu">
                            <li>
                                <a href="#">Action</a>
                            </li>
                            <li>
                                <a href="#">Another action</a>
                            </li>
                            <li>
                                <a href="#">Something else here</a>
                            </li>
                            <li class="divider">
                            </li>
                            <li>
                                <a href="#">Separated link</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>*@
        <!-- END PAGE HEADER-->
        <!-- BEGIN PAGE CONTENT-->
        <div class="row">
            <div class="col-md-12">

                <!-- Begin: life time stats -->
                <div class="portlet">

                    <div class="portlet-title">
                        <div class="tab-pane" id="tab_1">
                            <div class="portlet box blue">
                                <div class="portlet-title">
                                    <div class="caption">
                                        <i class="fa fa-gift"></i>Thêm thông trước khi export
                                    </div>
                                    <div class="tools">
                                        <a href="javascript:;" class="collapse">
                                        </a>
                                        <a href="#portlet-config" data-toggle="modal" class="config">
                                        </a>
                                        <a href="javascript:;" class="reload">
                                        </a>
                                        <a href="javascript:;" class="remove">
                                        </a>
                                    </div>
                                </div>
                                <div class="portlet-body form">
                                    <!-- BEGIN FORM-->
                                    <form class="horizontal-form">
                                        <div class="form-body">

                                            <div class="row">

                                            </div>
                                            <div class="row">

                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">

                                                    </div>

                                                </div>
                                                <!--/span-->
                                                <div class="col-md-6">
                                                    <div class="form-group">

                                                    </div>
                                                </div>
                                                <!--/span-->
                                            </div>

                                            <!--/row-->

                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-3">PartnerCode</label>
                                                        <input id="partnerCode" type="text" class="form-control">
                                                    </div>
                                                </div>
                                                <!--/span-->
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-3">CampaignCode</label>
                                                        <input id="campaignCode" type="text" class="form-control">
                                                    </div>
                                                </div>
                                                <!--/span-->
                                            </div>
                                            <!--/row-->
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-3">SourceApiExcel</label>
                                                        <input id="sourceApiExcel" type="text" class="form-control">
                                                    </div>
                                                </div>
                                                <!--/span-->
                                                <!--/span-->
                                            </div>
                                        </div>

                                    </form>

                                    <!-- END FORM-->
                                </div>
                            </div>

                        </div>
                    </div>
                    <div class="portlet-title">
                        <div class="tab-pane" id="tab_1">
                            <div class="portlet box blue">
                                <div class="portlet-title">
                                    <div class="caption">
                                        <i class="fa fa-gift"></i>Bộ Lọc tìm kiếm LEAD sạch
                                    </div>
                                    <div class="tools">
                                        <a href="javascript:;" class="collapse">
                                        </a>
                                        <a href="#portlet-config" data-toggle="modal" class="config">
                                        </a>
                                        <a href="javascript:;" class="reload">
                                        </a>
                                        <a href="javascript:;" class="remove">
                                        </a>
                                    </div>
                                </div>
                                <div class="portlet-body form">
                                    <!-- BEGIN FORM-->
                                    <form class="horizontal-form">
                                        <div class="form-body">

                                            <div class="row">

                                            </div>
                                            <div class="row">

                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">

                                                    </div>

                                                </div>
                                                <!--/span-->
                                                <div class="col-md-6">
                                                    <div class="form-group">

                                                    </div>
                                                </div>
                                                <!--/span-->
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-2">ValiDate</label>
                                                        <div class="col-md-4">
                                                            <div class="input-group input-large date-picker input-daterange" data-date="10/11/2012" data-date-format="mm/dd/yyyy">
                                                                <input type="text" class="form-control" id="valiDateFrom">
                                                                <span class="input-group-addon">
                                                                    to
                                                                </span>
                                                                <input type="text" class="form-control" id="valiDateTo">
                                                            </div>
                                                            <!-- /input-group -->

                                                        </div>
                                                    </div>

                                                </div>
                                                <!--/span-->
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-2">PostDate</label>
                                                        <div class="col-md-4">
                                                            <div class="input-group input-large date-picker input-daterange" data-date="10/11/2012" data-date-format="mm/dd/yyyy">
                                                                <input type="text" class="form-control" id="postDateFrom">
                                                                <span class="input-group-addon">
                                                                    to
                                                                </span>
                                                                <input type="text" class="form-control" id="postDateTo">
                                                            </div>
                                                            <!-- /input-group -->

                                                        </div>
                                                    </div>
                                                </div>
                                                <!--/span-->
                                            </div>
                                            <!--/row-->

                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-3">Bound Code</label>
                                                        <input id="boundCode" type="text" class="form-control">
                                                    </div>
                                                </div>
                                                <!--/span-->
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-3">Province</label>
                                                        <input id="province" type="text" class="form-control">
                                                    </div>
                                                </div>
                                                <!--/span-->
                                            </div>
                                            <!--/row-->
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-3">Dự Án</label>
                                                        <input id="duAn" type="text" class="form-control">
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-3">Số điện thoại</label>
                                                        <input id="phoneNumber" type="text" class="form-control">
                                                    </div>
                                                </div>
                                                <!--/span-->
                                                <!--/span-->
                                            </div>
                                        </div>

                                    </form>
                                    <div>
                                        <div class="form-actions right">
                                            <button id="searchLeadSach" type="search" class="btn blue"><i class="fa search"></i> Tìm Kiếm</button>
                                            <button onclick="exportLeadSach()" type="submit" class="btn blue"><i class="fa search"></i> Export</button>

                                        </div>

                                    </div>
                                    <!-- END FORM-->
                                </div>
                            </div>

                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-12">

                            <!-- Begin: life time stats -->
                            <!-- End: life time stats -->
                            <div class="portlet box blue-hoki">
                                <div class="portlet-title">
                                    <div class="caption">
                                        <i class="fa fa-globe"></i>List Lead Sạch
                                    </div>
                                    <div class="tools">
                                    </div>
                                </div>
                                <div class="portlet-body">
                                    <table class="table table-striped table-bordered table-hover">
                                        <thead>
                                            <tr role="row" class="heading">

                                                <th width="5%">
                                                    Số điện thoại
                                                </th>
                                                <th width="15%">
                                                    Validate
                                                </th>
                                                <th width="15%">
                                                    Mã tỉnh thành
                                                </th>
                                                <th width="10%">
                                                    Thang điểm thẻ
                                                </th>
                                                <th width="10%">
                                                    Hạn mức thẻ
                                                </th>
                                                <th width="10%">
                                                    Hạn mức vay
                                                </th>

                                                <th width="10%">
                                                    Thang điêm vay
                                                </th>
                                                <th width="10%">
                                                    Bound_Code
                                                </th>
                                                <th width="10%">
                                                    Lãi suất
                                                </th>

                                            </tr>
                                        </thead>
                                        <tbody id="aaa"></tbody>
                                    </table>
                                    <div id="pagination" class="pagination">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>


                </div>
                <!-- End: life time stats -->
            </div>
        </div>
        <!-- END PAGE CONTENT-->
    </div>
</div>
@section scripLeadSachFoot{
    <link rel="stylesheet" type="text/css" href="/Assets/global/plugins/clockface/css/clockface.css" />
    <link rel="stylesheet" type="text/css" href="/Assets/global/plugins/bootstrap-datepicker/css/bootstrap-datepicker3.min.css" />
    <link rel="stylesheet" type="text/css" href="/Assets/global/plugins/bootstrap-timepicker/css/bootstrap-timepicker.min.css" />
    <link rel="stylesheet" type="text/css" href="/Assets/global/plugins/bootstrap-colorpicker/css/colorpicker.css" />
    <link rel="stylesheet" type="text/css" href="/Assets/global/plugins/bootstrap-daterangepicker/daterangepicker-bs3.css" />
    <link rel="stylesheet" type="text/css" href="/Assets/global/plugins/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css" />
    <script type="text/javascript" src="/Assets/global/plugins/bootstrap-datepicker/js/bootstrap-datepicker.min.js"></script>
    <script type="text/javascript" src="/Assets/global/plugins/bootstrap-timepicker/js/bootstrap-timepicker.min.js"></script>
    <script type="text/javascript" src="/Assets/global/plugins/clockface/js/clockface.js"></script>
    <script type="text/javascript" src="/Assets/global/plugins/bootstrap-daterangepicker/moment.min.js"></script>
    <script type="text/javascript" src="/Assets/global/plugins/bootstrap-daterangepicker/daterangepicker.js"></script>
    <script type="text/javascript" src="/Assets/global/plugins/bootstrap-colorpicker/js/bootstrap-colorpicker.js"></script>
    <script type="text/javascript" src="/Assets/global/plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
    <script type="text/javascript" src="/Assets/global/plugins/select2/select2.min.js"></script>
    <script type="text/javascript" src="/Assets/global/plugins/datatables/media/js/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="/Assets/global/plugins/datatables/extensions/TableTools/js/dataTables.tableTools.min.js"></script>
    <script type="text/javascript" src="/Assets/global/plugins/datatables/extensions/ColReorder/js/dataTables.colReorder.min.js"></script>
    <script type="text/javascript" src="/Assets/global/plugins/datatables/extensions/Scroller/js/dataTables.scroller.min.js"></script>
    <script type="text/javascript" src="/Assets/global/plugins/datatables/plugins/bootstrap/dataTables.bootstrap.js"></script>
    <!-- END PAGE LEVEL PLUGINS -->
    <!-- BEGIN PAGE LEVEL SCRIPTS -->
    <script src="/Assets/global/scripts/metronic.js" type="text/javascript"></script>
    <script src="/Assets/admin/layout/scripts/layout.js" type="text/javascript"></script>
    <script src="/Assets/admin/layout/scripts/quick-sidebar.js" type="text/javascript"></script>
    <script src="/Assets/admin/layout/scripts/demo.js" type="text/javascript"></script>

    <script src="/Assets/admin/pages/scripts/components-pickers.js"></script>
    <script src="/Assets/admin/pages/scripts/table-advanced.js"></script>
    <script src="~/Scripts/mustache.min.js"></script>
    <script src="~/Scripts/jquery.twbsPagination.min.js"></script>
    <script src="~/Scripts/homeController.js"></script>
}
@section scripLeadSachJe{
    ComponentsPickers.init();
    TableAdvanced.init();
}
@section scripLeadSach{
    <script id="data-template" type="x-tmpl-mustache">
        <tr>
            <td>{{phone_number}}</td>
            <td>{{valid_date}}</td>
            <td>{{province_code}}</td>
            <td>{{band_cc}}</td>
            <td>{{cc_limit}}</td>
            <td>{{upl_limit}}</td>
            <td>{{band_upl}}</td>
            <td>{{bound_code}}</td>
            <td>{{upl_interest}}</td>
        </tr>
    </script>
    <script>
       $('#searchLeadSach').off('click').on('click', function () {
            debugger;
            homeController.loadData(true);
        });      

    function serchLeadSach() {
        debugger;
        var table = $('#sample_5').DataTable;

     var dataObject = JSON.stringify({
    'PartnerCode': $('#partnerCode').val(),
    'CampaignCode': $('#campaignCode').val(),
    'SourceApiExcel': $('#sourceApiExcel').val(),
    'Phone_Number': $('#phoneNumber').val(),
    'Bound_Code': $('#boundCode').val(),
    'Post_Date_From': $('#postDateFrom').val(),
    'Post_Date_To': $('#postDateTo').val(),
    'Province': $('#province').val(),
    'DuAn': $('#duAn').val(),
    'Valid_Date_From': $('#valiDateFrom').val(),
    'Valid_Date_To': $('#valiDateTo').val()

    });
        $.ajax({

        type: 'POST',
        url: "@Url.Action("Search", "LeadSach")"  ,
        contentType: "application/json; charset=utf-8",
        data: dataObject,
        success: function (result)
        {

            $("#aaa").html(result);
            table.ajax.reload();
            //table.reload();
//            $('#sample_5').DataTable( {
//    destroy: true,
//    searching: false
//} );
            }

        });





    }

    function exportLeadSach() {
        var dataObject = JSON.stringify({
    'PartnerCode': $('#partnerCode').val(),
    'CampaignCode': $('#campaignCode').val(),
    'SourceApiExcel': $('#sourceApiExcel').val(),
    'Phone_Number': $('#phoneNumber').val(),
    'Bound_Code': $('#boundCode').val(),
    'Post_Date_From': $('#postDateFrom').val(),
    'Post_Date_To': $('#postDateTo').val(),
    'Province': $('#province').val(),
    'DuAn': $('#duAn').val(),
    'Valid_Date_From': $('#valiDateFrom').val(),
    'Valid_Date_To': $('#valiDateTo').val()

        });
        debugger
        console.log("2");
        $.ajax({
            type: 'POST',
        url: "@Url.Action("ExportExcel", "LeadSach")"  ,
       contentType: "application/json; charset=utf-8",
        data: dataObject,
        }).done(function (data) {
            if (data.fileName != "") {
                console.log("1");
                //use window.location.href for redirect to download action for download the file
                window.location.href = "@Url.RouteUrl(new { Controller = "LeadSach", Action = "Download" })/?fileName=" + data.fileName;
            }
        });
    }

    </script>

    <script>


    </script>
}